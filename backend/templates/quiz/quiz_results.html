{% extends 'base/content.html' %}
{% block body %}

    <h1>{{ quiz.title }} Нәтижелері</h1>
    {% if attempt.is_passed %}
        <p>{{ quiz.success_text }}</p>
    {% else %}
        <p>{{ quiz.fail_text }}</p>
    {% endif %}
    <p>Сіз {{ attempt.percentage }}% дұрыс жауап бердіңіз!</p>
    <div class="card p-3">
        {% for attemptquestion in attempt.attemptquestion_set.all %}
            <h5>{{ forloop.counter }}. {{ attemptquestion.question.content }}</h5>
            {% if attemptquestion.question.figure %}
                <img src="{{ attemptquestion.question.figure.url }}" alt="" width="200px">
            {% endif %}
            {% if attemptquestion.is_correct %}
                <div class="answers p-2">
                    {% for answer in attemptquestion.question.answers.all %}
                        <p class="{% if answer.correct %}text-success{% endif %}">{{ forloop.counter }}) {{ answer.content }}</p>
                    {% endfor %}
                    <p class="text-success">Your answers:
                        {% for given_answer in attemptquestion.given_answers.all %}
                            {{ given_answer }}{% if not forloop.last %},
                            {% endif %}
                        {% endfor %}
                    </p>
                    <p class="text-success">Ұпай: {{ attemptquestion.score }}</p>
                </div>
            {% else %}
                <div class="answers p-2">
                    {% for answer in attemptquestion.question.answers.all %}
                        <p class="{% if answer.correct %}text-success{% endif %}">{{ forloop.counter }}) {{ answer.content }}</p>
                    {% endfor %}
                    <p class="text-danger">Жауаптарыңыз: {% for given_answer in attemptquestion.given_answers.all %}
                        <span class="{% if given_answer.correct %}text-success{% else %}text-danger{% endif %} ">{{ given_answer }}</span>
                        {% if not forloop.last %},
                        {% endif %}
                    {% endfor %}
                    </p>
                    <p class="text-danger">Ұпай: {{ attemptquestion.score }}</p>
                </div>
                <h4>Түсіндірме:</h4>
                <p class="lead">{{ attemptquestion.question.explanation|safe }}</p>
            {% endif %}
        {% endfor %}
    </div>
    <a class="btn btn-secondary mt-3" href="{% url 'quiz:quiz_detail' quiz.url %}">Артқа қайту</a>
{% endblock %}